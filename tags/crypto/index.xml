<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Crypto on Clingm&#39;s Blog</title>
    <link>https://clingm.github.io/tags/crypto/</link>
    <description>Recent content in Crypto on Clingm&#39;s Blog</description>
    <generator>Hugo</generator>
    <language>en-us</language>
    <copyright>Â© Clingm</copyright>
    <lastBuildDate>Fri, 08 Nov 2024 21:58:19 +0800</lastBuildDate>
    <atom:link href="https://clingm.github.io/tags/crypto/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Qwbctf 2023</title>
      <link>https://clingm.github.io/posts/crypto/qwbctf-2023/</link>
      <pubDate>Fri, 22 Dec 2023 15:06:27 +0800</pubDate>
      <guid>https://clingm.github.io/posts/crypto/qwbctf-2023/</guid>
      <description>&lt;p&gt;æ–°ä¸€å¹´çš„å¼ºç½‘æ¯ï¼Œä½†æˆ‘è¿˜æ˜¯ä¸€å¦‚æ—¢å¾€çš„èœã€‚&lt;/p&gt;&#xA;&lt;h2 id=&#34;not-only-rsa&#34;&gt;not only rsa&lt;/h2&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#81c8be&#34;&gt;from&lt;/span&gt; &lt;span style=&#34;color:#ef9f76&#34;&gt;Crypto.Util.number&lt;/span&gt; &lt;span style=&#34;color:#81c8be&#34;&gt;import&lt;/span&gt; bytes_to_long&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#81c8be&#34;&gt;from&lt;/span&gt; &lt;span style=&#34;color:#ef9f76&#34;&gt;secret&lt;/span&gt; &lt;span style=&#34;color:#81c8be&#34;&gt;import&lt;/span&gt; flag&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#81c8be&#34;&gt;import&lt;/span&gt; &lt;span style=&#34;color:#ef9f76&#34;&gt;os&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    n &lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ef9f76&#34;&gt;6249734963373034215610144758924910630356277447014258270888329547267471837899275103421406467763122499270790512099702898939814547982931674247240623063334781529511973585977522269522704997379194673181703247780179146749499072297334876619475914747479522310651303344623434565831770309615574478274456549054332451773452773119453059618433160299319070430295124113199473337940505806777950838270849&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    e &lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ef9f76&#34;&gt;641747&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    m &lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;=&lt;/span&gt; bytes_to_long(flag)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    flag &lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;=&lt;/span&gt; flag &lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;+&lt;/span&gt; os&lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;.&lt;/span&gt;urandom(n&lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;.&lt;/span&gt;bit_length() &lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;//&lt;/span&gt; &lt;span style=&#34;color:#ef9f76&#34;&gt;8&lt;/span&gt; &lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color:#99d1db&#34;&gt;len&lt;/span&gt;(flag) &lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color:#ef9f76&#34;&gt;1&lt;/span&gt;)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    m &lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;=&lt;/span&gt; bytes_to_long(flag)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    c &lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#99d1db&#34;&gt;pow&lt;/span&gt;(m, e, n)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ca9ee6&#34;&gt;with&lt;/span&gt; &lt;span style=&#34;color:#99d1db&#34;&gt;open&lt;/span&gt;(&lt;span style=&#34;color:#a6d189&#34;&gt;&amp;#39;out.txt&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#a6d189&#34;&gt;&amp;#39;w&amp;#39;&lt;/span&gt;) &lt;span style=&#34;color:#ca9ee6&#34;&gt;as&lt;/span&gt; f:&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#99d1db&#34;&gt;print&lt;/span&gt;(&lt;span style=&#34;color:#e78284&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#a6d189&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#a6d189&#34;&gt;{&lt;/span&gt;n &lt;span style=&#34;color:#a6d189&#34;&gt;= }&lt;/span&gt;&lt;span style=&#34;color:#a6d189&#34;&gt;&amp;#34;&lt;/span&gt;, file&lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;=&lt;/span&gt;f)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#99d1db&#34;&gt;print&lt;/span&gt;(&lt;span style=&#34;color:#e78284&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#a6d189&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#a6d189&#34;&gt;{&lt;/span&gt;e &lt;span style=&#34;color:#a6d189&#34;&gt;= }&lt;/span&gt;&lt;span style=&#34;color:#a6d189&#34;&gt;&amp;#34;&lt;/span&gt;, file&lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;=&lt;/span&gt;f)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#99d1db&#34;&gt;print&lt;/span&gt;(&lt;span style=&#34;color:#e78284&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#a6d189&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#a6d189&#34;&gt;{&lt;/span&gt;c &lt;span style=&#34;color:#a6d189&#34;&gt;= }&lt;/span&gt;&lt;span style=&#34;color:#a6d189&#34;&gt;&amp;#34;&lt;/span&gt;, file&lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;=&lt;/span&gt;f)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æºç å¾ˆçŸ­ï¼Œè€Œä¸”è¿™ä¸ªnå¯ä»¥ç›´æ¥åœ¨&lt;a href=&#34;http://factordb.com&#34;&gt;factordb&lt;/a&gt;é‡Œé¢æŸ¥ã€‚å‘ç°æ˜¯$p^5$çš„å½¢å¼ã€‚ç»§è€Œè®¡ç®—$\phi$, ä½†æ˜¯å‘ç°å’Œeä¸äº’ç´ ï¼Œè€Œä¸”eæ˜¯å…¶ä¸€ä¸ªå› å­ï¼Œé‚£ä¹ˆæ–¹æ³•å°±åªèƒ½å¼€æ ¹äº†ã€‚æˆ‘åœ¨æ¯”èµ›ä¸­å…¶å®å°±æƒ³åˆ°äº†AMM + hensel-liftingçš„æ–¹æ³•ï¼Œä½†æ˜¯æˆ‘å†™çš„ä»£ç å®åœ¨è·‘çš„å¤ªæ…¢ã€‚èµ›åçœ‹äº†N1çš„WPæ„Ÿè§‰æ˜¯sagemath polynomialçš„å¤§å¹‚æ•°è®¡ç®—çš„åŸå› ğŸ¤£&lt;/p&gt;&#xA;&lt;p&gt;æˆ‘ä¸€å¼€å§‹å†™çš„ä»£ç &lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#81c8be&#34;&gt;from&lt;/span&gt; &lt;span style=&#34;color:#ef9f76&#34;&gt;Crypto.Util.number&lt;/span&gt; &lt;span style=&#34;color:#81c8be&#34;&gt;import&lt;/span&gt; &lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;*&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#81c8be&#34;&gt;import&lt;/span&gt; &lt;span style=&#34;color:#ef9f76&#34;&gt;sys&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    sys&lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;.&lt;/span&gt;path&lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;.&lt;/span&gt;append(&lt;span style=&#34;color:#a6d189&#34;&gt;&amp;#34;/home/tr0uble/CTF/tools/crypto-attacks/&amp;#34;&lt;/span&gt;)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#81c8be&#34;&gt;from&lt;/span&gt; &lt;span style=&#34;color:#ef9f76&#34;&gt;shared&lt;/span&gt; &lt;span style=&#34;color:#81c8be&#34;&gt;import&lt;/span&gt; rth_roots&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#81c8be&#34;&gt;from&lt;/span&gt; &lt;span style=&#34;color:#ef9f76&#34;&gt;sage.all&lt;/span&gt; &lt;span style=&#34;color:#81c8be&#34;&gt;import&lt;/span&gt; GF, ZZ, Zmod, inverse_mod&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#81c8be&#34;&gt;from&lt;/span&gt; &lt;span style=&#34;color:#ef9f76&#34;&gt;tqdm&lt;/span&gt; &lt;span style=&#34;color:#81c8be&#34;&gt;import&lt;/span&gt; tqdm&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    n &lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ef9f76&#34;&gt;6249734963373034215610144758924910630356277447014258270888329547267471837899275103421406467763122499270790512099702898939814547982931674247240623063334781529511973585977522269522704997379194673181703247780179146749499072297334876619475914747479522310651303344623434565831770309615574478274456549054332451773452773119453059618433160299319070430295124113199473337940505806777950838270849&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    e &lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ef9f76&#34;&gt;641747&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    c &lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ef9f76&#34;&gt;730024611795626517480532940587152891926416120514706825368440230330259913837764632826884065065554839415540061752397144140563698277864414584568812699048873820551131185796851863064509294123861487954267708318027370912496252338232193619491860340395824180108335802813022066531232025997349683725357024257420090981323217296019482516072036780365510855555146547481407283231721904830868033930943&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    p &lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ef9f76&#34;&gt;91027438112295439314606669837102361953591324472804851543344131406676387779969&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    mps &lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#99d1db&#34;&gt;list&lt;/span&gt;(rth_roots(GF(p), c &lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;%&lt;/span&gt; p, e))&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#81c8be&#34;&gt;from&lt;/span&gt; &lt;span style=&#34;color:#ef9f76&#34;&gt;Crypto.Util.number&lt;/span&gt; &lt;span style=&#34;color:#81c8be&#34;&gt;import&lt;/span&gt; &lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;*&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ca9ee6&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#8caaee&#34;&gt;hensel_lifting&lt;/span&gt;(f, p, k, m, r, method&lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#a6d189&#34;&gt;&amp;#34;drop&amp;#34;&lt;/span&gt;):&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ca9ee6&#34;&gt;assert&lt;/span&gt; m &lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;&amp;lt;=&lt;/span&gt; k, &lt;span style=&#34;color:#a6d189&#34;&gt;&amp;#34;m must less equal to k&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        pk &lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;=&lt;/span&gt; p &lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;**&lt;/span&gt; k&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        pm &lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;=&lt;/span&gt; p &lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;**&lt;/span&gt; m&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        fd &lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;=&lt;/span&gt; f&lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;.&lt;/span&gt;diff()&lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;.&lt;/span&gt;change_ring(Zmod(pm))&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#737994;font-style:italic&#34;&gt;# print(fd)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#737994;font-style:italic&#34;&gt;# print(fd.base_ring())&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ca9ee6&#34;&gt;assert&lt;/span&gt; fd(r) &lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;!=&lt;/span&gt; &lt;span style=&#34;color:#ef9f76&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#a6d189&#34;&gt;&amp;#34;The difference of polynomial on x must not equal to zero&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#737994;font-style:italic&#34;&gt;# pn = pk * p&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        f_ &lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;=&lt;/span&gt; f&lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;.&lt;/span&gt;change_ring(Zmod(pk&lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;*&lt;/span&gt;pm))&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#737994;font-style:italic&#34;&gt;# while f_(r) == 0:&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#737994;font-style:italic&#34;&gt;#     pn *= p&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#737994;font-style:italic&#34;&gt;#     f_ = f.change_ring(Zmod(pn))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#737994;font-style:italic&#34;&gt;# if pn &amp;gt; pk*pm:&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#737994;font-style:italic&#34;&gt;#     return r&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#737994;font-style:italic&#34;&gt;# print(pn)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        t &lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;-&lt;/span&gt;((&lt;span style=&#34;color:#99d1db&#34;&gt;int&lt;/span&gt;(f_(r)) &lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;//&lt;/span&gt; pk &lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;%&lt;/span&gt; pk) &lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#99d1db&#34;&gt;int&lt;/span&gt;(fd(r)&lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;.&lt;/span&gt;inverse())) &lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;%&lt;/span&gt; pm&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        new_root &lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;=&lt;/span&gt; r &lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;+&lt;/span&gt; pk &lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;*&lt;/span&gt; t&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ca9ee6&#34;&gt;assert&lt;/span&gt; f&lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;.&lt;/span&gt;change_ring(Zmod(pk&lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;*&lt;/span&gt;pm))(new_root) &lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#ef9f76&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#a6d189&#34;&gt;&amp;#34;Can&amp;#39;t to lifting&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ca9ee6&#34;&gt;return&lt;/span&gt; new_root&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    x &lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;=&lt;/span&gt; ZZ[&lt;span style=&#34;color:#a6d189&#34;&gt;&amp;#39;x&amp;#39;&lt;/span&gt;]&lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;.&lt;/span&gt;gen()&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    f &lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;=&lt;/span&gt; x&lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;**&lt;/span&gt;e &lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;-&lt;/span&gt; c&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ca9ee6&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#8caaee&#34;&gt;hensel_lift5&lt;/span&gt;(r, p):&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ca9ee6&#34;&gt;for&lt;/span&gt; i &lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;in&lt;/span&gt; &lt;span style=&#34;color:#99d1db&#34;&gt;range&lt;/span&gt;(&lt;span style=&#34;color:#ef9f76&#34;&gt;4&lt;/span&gt;):&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            r &lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;=&lt;/span&gt; hensel_lifting(f, p, i&lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ef9f76&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#ef9f76&#34;&gt;1&lt;/span&gt;, r)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ca9ee6&#34;&gt;return&lt;/span&gt; r&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ca9ee6&#34;&gt;for&lt;/span&gt; i &lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;in&lt;/span&gt; tqdm(&lt;span style=&#34;color:#99d1db&#34;&gt;range&lt;/span&gt;(&lt;span style=&#34;color:#99d1db&#34;&gt;len&lt;/span&gt;(mps))):&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        ct &lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;=&lt;/span&gt; hensel_lift5(&lt;span style=&#34;color:#99d1db&#34;&gt;int&lt;/span&gt;(mps[i]), p)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ca9ee6&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#e78284&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#a6d189&#34;&gt;&amp;#39;flag&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#99d1db;font-weight:bold&#34;&gt;in&lt;/span&gt; long_to_bytes(ct):&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#99d1db&#34;&gt;print&lt;/span&gt;(long_to_bytes(ct))&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™ä¸ªæ ·å­æ ¹æœ¬è·‘ä¸åŠ¨ï¼Œåœ¨çœ‹äº†N1çš„WPåæˆ‘ä¹ŸæŠŠpolynomialæ”¹æˆæ™®é€šçš„ &lt;code&gt;pow(r, e, p) - c&lt;/code&gt; çš„æ ·å­ï¼Œä»£ç å˜æˆ&lt;/p&gt;</description>
    </item>
    <item>
      <title>Dive Into Coppersmith</title>
      <link>https://clingm.github.io/posts/crypto/dive-into-coppersmith/</link>
      <pubDate>Fri, 15 Dec 2023 15:18:33 +0800</pubDate>
      <guid>https://clingm.github.io/posts/crypto/dive-into-coppersmith/</guid>
      <description>&lt;h2 id=&#34;introduction-of-coppersmiths-method&#34;&gt;Introduction of Coppersmithâ€™s Method&lt;/h2&gt;&#xA;&lt;p&gt;1996å¹´ Don Coppersmith å‘è¡¨äº†ä¸¤ç‰‡è®ºæ–‡ï¼Œâ€œFinding a Small Root of a Univariate Modular Equationâ€, â€œFinding a Small Root of a Bivariate Integer Equation; Factoring with High Bits Knownâ€ï¼Œç¬¬ä¸€ç¯‡è®¨è®ºå¦‚ä½•æ±‚å•å˜é‡æ¨¡æ–¹ç¨‹çš„å°æ ¹ï¼Œç¬¬äºŒç¯‡è®¨è®ºå¦‚ä½•æ±‚åŒå˜é‡æ•´æ•°æ–¹ç¨‹çš„å°æ ¹ï¼Œå¹¶ä¸”æŠŠæ•´æ•°æ–¹ç¨‹æ‹“å±•åˆ°äº†æ¨¡æ–¹ç¨‹ã€‚&lt;/p&gt;&#xA;&lt;p&gt;Coppersmithâ€™s Method åœ¨å…¬é’¥å¯†ç å­¦ä¸­æœ‰ä¸¾è¶³è½»é‡çš„åœ°ä½ï¼Œåœ¨å¤§å¤šæ•°RSAçš„æ”»å‡»æ–‡ç« ä¸­éƒ½æœ‰æ¶‰åŠåˆ°ã€‚æ‰€ä»¥æ„Ÿè§‰è¿˜æ˜¯ä¸èƒ½å°±åœç•™åœ¨å¹³å¸¸æ‰“CTFæ¯”èµ›ä¸­éšä¾¿è°ƒç”¨ä¸€ä¸‹ &lt;code&gt;small_roots&lt;/code&gt; å°±okçš„ç¨‹åº¦ï¼Œè‡³å°‘è¦çŸ¥é“å…¶ä¸­çš„åŸç†ã€‚&lt;/p&gt;&#xA;&lt;p&gt;è¿™æ¬¡çš„å­¦ä¹ ä¸»è¦åŸºäºSteven Galbraithæ•™æˆå†™çš„ â€œMathematics of Public Key Cryptograph&amp;quot; è¿™æœ¬ä¹¦ä¸­çš„ç¬¬19ç« çš„å†…å®¹ã€‚&lt;/p&gt;&#xA;&lt;h2 id=&#34;for-modular-univariate-polynomials&#34;&gt;For Modular Univariate Polynomials&lt;/h2&gt;&#xA;&lt;p&gt;æœ‰å¤šé¡¹å¼ $F(x)=s^d + a_{d-1}x^{d-1} + \cdots + a_1x+a_0$ æ˜¯ä¸€ä¸ªé¦–ä¸€çš„æ•´ç³»æ•°çš„dæ¬¡å¤šé¡¹å¼ã€‚å‡è®¾æˆ‘ä»¬çŸ¥é“å­˜åœ¨$x_0$ä½¿ $F(x_0)=0\ (mod\ M)$ å¹¶ä¸” $|x_0| &amp;lt; M^{1/d}$ã€‚é—®é¢˜å°±æ˜¯æ‰¾åˆ°æ‰€æœ‰è¿™æ ·å­çš„æ ¹ã€‚&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;PS: ä¹‹åå°†ä½¿ç”¨ $F_M(x)$ æ¥è¡¨ç¤ºæ¨¡Mçš„å¤šé¡¹å¼ï¼Œ$F(x)$æ¥è¡¨ç¤ºæ•´æ•°å¤šé¡¹å¼ã€‚&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;p&gt;Coppersmithâ€™s Method çš„æ ¸å¿ƒæ€æƒ³æ˜¯åˆ›å»ºä¸€ä¸ªæ–¹ç¨‹$G(x)$ï¼Œè€Œä¸” $G(x_0)=F_M(x_0)=0$ï¼Œå³$G(x)$æ‹¥æœ‰ä¸$F_M(x)$ç›¸åŒçš„è§£ï¼Œä¸”$G(x)$çš„ç³»æ•°è¶³å¤Ÿå°å¯ä»¥ç›´æ¥ç®—å‡º$x_0$ã€‚&lt;/p&gt;</description>
    </item>
    <item>
      <title>çœèµ›åˆèµ›å°è®°</title>
      <link>https://clingm.github.io/posts/crypto/zjss2023/</link>
      <pubDate>Sat, 04 Nov 2023 15:22:00 +0800</pubDate>
      <guid>https://clingm.github.io/posts/crypto/zjss2023/</guid>
      <description>&lt;p&gt;ä»Šå¹´å†æ¬¡å‚åŠ äº†æµ™æ±Ÿçœèµ›ï¼Œä»Šå¹´æ˜¯ç¬¬äºŒæ¬¡å‚èµ›äº†ï¼Œä¸é˜Ÿå†…çš„webå’Œbinå¤§æ‰‹å­ä¸€èµ·ç»„äº†é˜Ÿï¼Œè¿™æ¬¡é¢„èµ›çš„æˆç»©è¿˜æ˜¯ä¸é”™çš„ï¼Œæ‹¿åˆ°ç¬¬6ï¼Œå†³èµ›å·²ç»ç¨³äº†ã€‚è¿™ç¯‡blogå°±è®°å½•ä¸€ä¸‹èµ›ä¸­è§£çš„Cryptoé¢˜æ°´ä¸€ç¯‡ã€‚&lt;/p&gt;&#xA;&lt;h4 id=&#34;å°å°æ•°å­¦å®¶&#34;&gt;å°å°æ•°å­¦å®¶&lt;/h4&gt;&#xA;&lt;p&gt;çœ‹åˆ°é¢˜ç›®å†…å®¹å’Œé™„ä»¶ï¼Œå°±ç›´æ¥æŒ‰ç…§æè¿°æ‰€è¯´ï¼Œè®¡ç®—ä¸€å¨ç®—å¼å³å¯ï¼Œç›´æ¥eval()äº†&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;probs = open(&#39;flag.txt&#39;).readlines()&#xA;flag = []&#xA;for prob in probs:&#xA;    prob = prob[:-3]&#xA;    flag.append(int(eval(prob)))&#xA;&#xA;print(bytes(flag))&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/clingm/PicGo-image//img/image-20231104143931933.png&#34; alt=&#34;image-20231104143931933&#34;&gt;&lt;/p&gt;&#xA;&lt;h4 id=&#34;ec_party-iii&#34;&gt;EC_Party-III&lt;/h4&gt;&#xA;&lt;p&gt;é¢˜ç›®å…³é”®ä»£ç &lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;    p = getPrime(384)&#xA;    q = getPrime(384)&#xA;    n = p*q&#xA;    d = getPrime(80)&#xA;    e = inverse_mod(d, ord_p*ord_q)&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;ç›´æ¥å°±æƒ³åˆ°äº†wiener attackï¼Œåœ¨ECä¸­$Order(p) = p+1+\alpha$,alphaæ˜¯ä¸€ä¸ªå°äº$2\sqrt{p}$çš„æ•°ï¼Œæœ¬æ¥æ˜¯æƒ³è¦è°ƒä¸€ä¸‹çš„ï¼Œä½†æ˜¯å‘ç°ä¸ç”¨æ”¹ç›´æ¥è¿åˆ†æ•°å°±å‡ºäº†&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;from sage.all import *&#xA;from Crypto.Util.number import getPrime, long_to_bytes&#xA;&#xA;pk = [10517482889776460226798449006280081167663671198448544453304563030553066300585088657159799516828057458092448853052920, 10402402380108575947733278581108880071660185906203575453837669489513650182676772750843558327746184945922314875098996, 452239510514900186933709062848646640558105660312444312121851933676754687850508865659206624803226663304812888272594694285123823218948165607478144589871322148031514596122654196640778853480169180864412134209693877604844174450602155353, 137939931394124279393027766586199451754893501053862574760060288577053514723631473985259186063729745515767167268309839903521149677958518517988564142828176577685619561913731155508981456507557881596602396073589127827579264760182112015, (312312975924665463422872243489714243976133330669934414246404507993066820310886215600585539115436654843078716170526368558972800117033427241194242498913898005160762151892979826292737941332916578310350510245475526522735894588645243659, 422891099305786578397746684898210811095359530216631541482542541898542508551347882962281401572399110483550691802487377837504493122807091311281569558317360479103461652558448871769150783477147866528115922507893061101403528629595165327)]&#xA;a, b, n, e, C = pk&#xA;&#xA;E = EllipticCurve(Zmod(n), [a, b])&#xA;C = E(C)&#xA;print(C)&#xA;&#xA;def attack1(N, e):&#xA;    convergents = continued_fraction(ZZ(e) / ZZ(N)).convergents()&#xA;    for c in convergents:&#xA;        k = c.numerator()&#xA;        d = c.denominator()&#xA;        M = d*C&#xA;        flag = long_to_bytes(int(M.xy()[0]))&#xA;        try:&#xA;            print(flag[:-16].decode())&#xA;        except:&#xA;            continue&#xA;&#xA;print(attack1(n, e))&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/clingm/PicGo-image//img/image-20231104144602967.png&#34; alt=&#34;image-20231104144602967&#34;&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>è¿‘æœŸæ¯”èµ›çš„å¤ç°</title>
      <link>https://clingm.github.io/posts/crypto/currently-match/</link>
      <pubDate>Sun, 16 Jul 2023 15:24:01 +0800</pubDate>
      <guid>https://clingm.github.io/posts/crypto/currently-match/</guid>
      <description>&lt;p&gt;å¥½ä¹…æ²¡å†™blogäº†ã€‚ã€‚å¤ç°ä¸€ä¸‹æœ€è¿‘çš„æ¯”èµ›&lt;/p&gt;&#xA;&lt;h1 id=&#34;crypto-ctf-2023&#34;&gt;Crypto CTF 2023&lt;/h1&gt;&#xA;&lt;h2 id=&#34;medium&#34;&gt;Medium&lt;/h2&gt;&#xA;&lt;h3 id=&#34;blobfish&#34;&gt;blobfish&lt;/h3&gt;&#xA;&lt;pre&gt;&lt;code&gt;#!/usr/bin/env python3&#xA;&#xA;import os&#xA;from hashlib import md5&#xA;from Crypto.Cipher import AES&#xA;from Crypto.Random import get_random_bytes&#xA;from PIL import Image&#xA;from PIL import ImageDraw&#xA;from flag import flag&#xA;&#xA;key = get_random_bytes(8) * 2&#xA;iv = md5(key).digest()&#xA;&#xA;cipher = AES.new(key, AES.MODE_CFB, iv=iv)&#xA;enc = cipher.encrypt(flag)&#xA;&#xA;img = Image.new(&#39;RGB&#39;, (800, 50))&#xA;drw = ImageDraw.Draw(img)&#xA;drw.text((20, 20), enc.hex(), fill=(255, 0, 0))&#xA;img.save(&amp;quot;flag.png&amp;quot;)&#xA;&#xA;hkey = &#39;&#39;.join(&#39;\\x{:02x}&#39;.format(x) for x in key[:10])&#xA;&#xA;os.system(f&#39;/bin/zip -0 flag.zip flag.png -e -P \&amp;quot;$(/bin/echo -en \&amp;quot;{hkey}\&amp;quot;)\&amp;quot;&#39;)&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;æŠŠflagç”¨AESåŠ å¯†åç”»åˆ°ä¸€å¼ å›¾ç‰‡é‡Œï¼Œç„¶åç”¨zipå‹ç¼©ï¼Œè€Œä¸”æ˜¯æ— æŸå‹ç¼©ï¼Œå¯†ç å°±æ˜¯AES keyçš„å‰10ä¸ªå­—èŠ‚ã€‚&lt;/p&gt;</description>
    </item>
    <item>
      <title>UIUCTF 2023 Crypto WriteUps</title>
      <link>https://clingm.github.io/posts/crypto/uiuctf-2023-crypto-writeups/</link>
      <pubDate>Tue, 04 Jul 2023 15:27:00 +0800</pubDate>
      <guid>https://clingm.github.io/posts/crypto/uiuctf-2023-crypto-writeups/</guid>
      <description>&lt;p&gt;è¿™æ¬¡ç”¨IKUNä¸ºIDæ‰“äº†UIUCTFï¼Œè§£äº†å…¨éƒ¨çš„å¯†ç é¢˜ï¼Œéƒ½æŒºç®€å•çš„ã€‚&lt;/p&gt;&#xA;&lt;h1 id=&#34;three-time-pad&#34;&gt;Three-Time-Pad&lt;/h1&gt;&#xA;&lt;p&gt;é€šè¿‡é¢˜ç›®æè¿°å°±çŸ¥é“æ˜¯One-Time-Padçš„key reuseã€‚è€Œä¸”ç»™äº†ä¸€ä¸ªæ˜å¯†æ–‡å¯¹ï¼Œxorä¸€ä¸‹å°±å¾—åˆ°keyï¼Œç„¶åå»è§£å…¶ä»–çš„æ˜æ–‡å°±å¯ä»¥äº†&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;from Crypto.Util.strxor import strxor&#xA;&#xA;c1 = open(&#39;Three-Time Pad/c1&#39;, &#39;rb&#39;).read()&#xA;c2 = open(&#39;Three-Time Pad/c2&#39;, &#39;rb&#39;).read()&#xA;c3 = open(&#39;Three-Time Pad/c3&#39;, &#39;rb&#39;).read()&#xA;p2 = open(&#39;Three-Time Pad/p2&#39;, &#39;rb&#39;).read()&#xA;&#xA;key = strxor(c2 ,p2)&#xA;print(key)&#xA;print(strxor(key[:len(c3)], c3[:len(key)]))&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h1 id=&#34;morphing-time&#34;&gt;Morphing Time&lt;/h1&gt;&#xA;&lt;pre&gt;&lt;code&gt;#!/usr/bin/env python3&#xA;from Crypto.Util.number import getPrime&#xA;from random import randint&#xA;&#xA;with open(&amp;quot;/flag&amp;quot;, &amp;quot;rb&amp;quot;) as f:&#xA;    flag = int.from_bytes(f.read().strip(), &amp;quot;big&amp;quot;)&#xA;&#xA;&#xA;def setup():&#xA;    # Get group prime + generator&#xA;    p = getPrime(512)&#xA;    g = 2&#xA;&#xA;    return g, p&#xA;&#xA;&#xA;def key(g, p):&#xA;    # generate key info&#xA;    a = randint(2, p - 1)&#xA;    A = pow(g, a, p)&#xA;&#xA;    return a, A&#xA;&#xA;&#xA;def encrypt_setup(p, g, A):&#xA;    def encrypt(m):&#xA;        k = randint(2, p - 1)&#xA;        c1 = pow(g, k, p)&#xA;        c2 = pow(A, k, p)&#xA;        c2 = (m * c2) % p&#xA;&#xA;        return c1, c2&#xA;&#xA;    return encrypt&#xA;&#xA;&#xA;def decrypt_setup(a, p):&#xA;    def decrypt(c1, c2):&#xA;        m = pow(c1, a, p)&#xA;        m = pow(m, -1, p)&#xA;        m = (c2 * m) % p&#xA;&#xA;        return m&#xA;&#xA;    return decrypt&#xA;&#xA;&#xA;def main():&#xA;    print(&amp;quot;[$] Welcome to Morphing Time&amp;quot;)&#xA;&#xA;    g, p = 2, getPrime(512)&#xA;    a = randint(2, p - 1)&#xA;    A = pow(g, a, p)&#xA;    decrypt = decrypt\_setup(a, p)&#xA;    encrypt = encrypt\_setup(p, g, A)&#xA;    print(&amp;quot;[$] Public:&amp;quot;)&#xA;    print(f&amp;quot;[$]     {g = }&amp;quot;)&#xA;    print(f&amp;quot;[$]     {p = }&amp;quot;)&#xA;    print(f&amp;quot;[$]     {A = }&amp;quot;)&#xA;&#xA;    c1, c2 = encrypt(flag)&#xA;    print(&amp;quot;[$] Eavesdropped Message:&amp;quot;)&#xA;    print(f&amp;quot;[$]     {c1 = }&amp;quot;)&#xA;    print(f&amp;quot;[$]     {c2 = }&amp;quot;)&#xA;&#xA;    print(&amp;quot;[$] Give A Ciphertext (c1\_, c2\_) to the Oracle:&amp;quot;)&#xA;    try:&#xA;        c1\_ = input(&amp;quot;[$]     c1_ = &amp;quot;)&#xA;        c1_ = int(c1_)&#xA;        assert 1 &amp;lt; c1_ &amp;lt; p - 1&#xA;&#xA;        c2_ = input(&amp;quot;[$]     c2\_ = &amp;quot;)&#xA;        c2\_ = int(c2\_)&#xA;        assert 1 &amp;lt; c2\_ &amp;lt; p - 1&#xA;    except:&#xA;        print(&amp;quot;!! You&#39;ve Lost Your Chance !!&amp;quot;)&#xA;        exit(1)&#xA;&#xA;    print(&amp;quot;[$] Decryption of You-Know-What:&amp;quot;)&#xA;    m = decrypt((c1 * c1_) % p, (c2 * c2_) % p)&#xA;    print(f&amp;quot;[$]     {m = }&amp;quot;)&#xA;&#xA;    # !! NOTE !!&#xA;    # Convert your final result to plaintext using&#xA;    # long\_to\_bytes&#xA;&#xA;    exit(0)&#xA;&#xA;&#xA;if \_\_name\_\_ == &amp;quot;\_\_main\_\_&amp;quot;:&#xA;    main()&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;é¢˜ç›®å…ˆç”Ÿæˆä¸€ä¸ªå¯†æ–‡å¯¹(c1, c2)ï¼Œç„¶åæˆ‘ä»¬å†æä¾›å¦ä¸€ä¸ªå¯†æ–‡å¯¹(c1\&lt;em&gt;, c2\&lt;/em&gt;)ï¼Œæœ€åè§£å¯†(c1*c1\&lt;em&gt;, c2*c2\&lt;/em&gt;)ã€‚è¿™ä¸ªåŠ å¯†å…¶å®å…·æœ‰åŒæ€çš„æ€§è´¨ï¼Œ$D(E(m1_m2))=m1_m2$ï¼Œæˆ‘çš„æ–¹æ³•æ˜¯æŠŠ(c1\&lt;em&gt;, c2\&lt;/em&gt;)=(c1, c2)ï¼Œå‘é€è¿‡å»ï¼Œdecryptç»“æœå¼€æ ¹å·&lt;/p&gt;</description>
    </item>
    <item>
      <title>Simple Study of Kannan&#39;s Embedding</title>
      <link>https://clingm.github.io/posts/crypto/simple-study-of-kannan-s-embedding/</link>
      <pubDate>Sun, 21 May 2023 15:28:49 +0800</pubDate>
      <guid>https://clingm.github.io/posts/crypto/simple-study-of-kannan-s-embedding/</guid>
      <description>&lt;p&gt;å…³äºLatticeé—®é¢˜çš„å¤ä¹ å’ŒKannanâ€™s Embedding for solve LWEçš„å­¦ä¹ è®°å½•&lt;/p&gt;&#xA;&lt;h2 id=&#34;svp&#34;&gt;SVP&lt;/h2&gt;&#xA;&lt;p&gt;SVP(shortset vector problem)æ˜¯æ‰¾åˆ°ä¸€ä¸ªæ ¼$L$ä¸Šçš„æœ€çŸ­å‘é‡ï¼Œæœ€çŸ­æŒ‡çš„æ˜¯Euclidean Norm(æ¬§å‡ é‡Œå¾—èŒƒå¼)æœ€å°ã€‚ä¸€ä¸ªæ ¼ä¸­æœ€å°‘æœ‰ä¸¤ä¸ªå…·æœ‰ç›¸åŒèŒƒå¼çš„æœ€çŸ­å‘é‡ï¼Œå¹¶ä¸”è¿™ä¸¤ä¸ªå‘é‡çš„ç¬¦å·ç›¸åï¼Œä¹Ÿå°±æ˜¯åå‘ã€‚æŠŠç¬¬ä¸€æœ€çŸ­å‘é‡è®°ä¸º$\lambda_{1}(L)$ï¼Œç¬¬äºŒæœ€çŸ­å‘é‡ä¸º$\lambda_2(L)$ã€‚&lt;/p&gt;&#xA;&lt;h3 id=&#34;usvp&#34;&gt;uSVP&lt;/h3&gt;&#xA;&lt;p&gt;uSVP(unique SVP)æ˜¯æŒ‡åœ¨ä¸€ä¸ªæ ¼ä¸­ï¼Œæ»¡è¶³$\lambda_1(L) \ll \lambda_2(L)$ï¼Œæ‰¾åˆ°$\lambda_1(L)$ã€‚æˆ–è€…ç»™ä¸€ä¸ªè¾…åŠ©å˜é‡$\gamma$ï¼Œ$\gamma\lambda_1(L) &amp;lt; \lambda_2(L)$ï¼ŒuSVPå°±å˜æˆ$\gamma$-uSVPï¼Œ$\gamma$å¯ä»¥çœ‹ä½œæ˜¯$\lambda_1(L)$å’Œ$\lambda_2(L)$ä¹‹é—´çš„gapã€‚æ‰€ä»¥$\gamma$-uSVPä¹Ÿå¯ä»¥å½“ä½œæ˜¯gapSVPã€‚$\gamma$è¶Šå¤§ï¼Œåœ¨è¿™ä¸ªæ ¼$L$ä¸­å°±è¶Šå®¹æ˜“æ‰¾åˆ°$\lambda_1(L)$ã€‚&lt;/p&gt;&#xA;&lt;h2 id=&#34;cvp&#34;&gt;CVP&lt;/h2&gt;&#xA;&lt;p&gt;CVP(closest vector problem)æ˜¯ç»™å®šä¸€ä¸ªæ ¼$L$å’Œä¸€ä¸ªä¸åœ¨$L$ä¸­çš„ç›®æ ‡å‘é‡$t$ï¼Œåœ¨$L$ä¸­æ‰¾åˆ°ä¸€ä¸ªå‘é‡$v$ï¼Œä¸$t$çš„è·ç¦»æœ€çŸ­ã€‚&lt;/p&gt;&#xA;&lt;h3 id=&#34;bdd&#34;&gt;BDD&lt;/h3&gt;&#xA;&lt;p&gt;BDD(Bounded Distance Decoding)æ˜¯åœ¨CVPä¸­è§„å®š$||v-t|| &amp;lt; \beta\lambda_1(L)$ï¼Œè€Œä¸”$\beta$å°äº0.5ï¼Œæ‰¾åˆ°çš„$v$ä¸€å®šæ˜¯å”¯ä¸€çš„ã€‚&lt;/p&gt;&#xA;&lt;h2 id=&#34;lwe&#34;&gt;LWE&lt;/h2&gt;&#xA;&lt;p&gt;æœ‰ä¸€ä¸ªçŸ©é˜µ$A\in\mathbb{Z}_q^{m\times n}$ï¼Œä¸€ä¸ªsecret vector $s\in\mathbb{Z}_q^n$ï¼Œè¿˜æœ‰ä¸€ä¸ªè¯¯å·®å‘é‡ $e\in\mathbb{Z}_q^m$ï¼Œå·²çŸ¥$(A,b=As+e)$ï¼Œæ±‚secret vector $s$ã€‚$n$ ç§°ä¸ºLWEé—®é¢˜çš„ç»´æ•°ï¼Œ$m$ ç§°ä¸ºLWEé—®é¢˜çš„æ ·æœ¬æ•°(simple number)ã€‚&lt;/p&gt;&#xA;&lt;h2 id=&#34;q-ary-lattice&#34;&gt;q-ary Lattice&lt;/h2&gt;&#xA;&lt;p&gt;q-ary Lattice å…¶å®å°±æ˜¯æŠŠä¸€ä¸ª$\mathbb{Z}_q$çš„çŸ©é˜µè½¬æ¢æˆ$\mathbb{Z}$ä¸Šçš„æ ¼ã€‚æ¯”å¦‚ä¸€ä¸ª$A\in\mathbb{Z}_q^{m\times n}$ï¼Œ$A$ çš„q-ary Latticeå°±æ˜¯ $$ L_{(\mathbf{A}, q)}=\left{\mathbf{y} \in \mathbb{Z}_{q}^{m} \mid \mathbf{y} \equiv \mathbf{A} \mathbf{x}(\bmod q) \text { for some } \mathbf{x} \in \mathbb{Z}^{n}\right} $$ $L_{(A,q)}$çš„åŸº$B$ï¼Œè¡¨ç¤ºä¸º $$ \mathbf{B}=\left(\frac{\mathbf{A}^{T}}{q \mathbf{I}_{m}}\right) \in \mathbb{Z}^{(m+n) \times m} $$ ç®€å•è¯æ˜ä¸€ä¸‹ï¼Œ $$ Ax\equiv b\pmod{q} \\ Ax +kq = b \\ [x_0, x_1,\cdots,x_n| k_0,k_1,\cdots,k_m] \begin{bmatrix} A^{T}\\qI_m \end{bmatrix} = [b_0,b_1,\cdots,b_m] $$&lt;/p&gt;</description>
    </item>
    <item>
      <title>Cryptanalysis of Rsa Variants With Primes Sharing Most Significant Bits</title>
      <link>https://clingm.github.io/posts/crypto/cryptanalysis-of-rsa-variants-with-primes-sharing-most-significant-bits/</link>
      <pubDate>Sat, 14 Jan 2023 15:31:52 +0800</pubDate>
      <guid>https://clingm.github.io/posts/crypto/cryptanalysis-of-rsa-variants-with-primes-sharing-most-significant-bits/</guid>
      <description>&lt;h2 id=&#34;æ¦‚è®º&#34;&gt;æ¦‚è®º&lt;/h2&gt;&#xA;&lt;p&gt;å½“RSAçš„å…¬é’¥eå’Œç§é’¥dæ»¡è¶³å…¬å¼$ed-k(p^2-1)(q^2-1)=1$ï¼Œå¦‚æœæ¨¡æ•°mçš„ä¸¤ä¸ªå› å­p,qæœ‰ç›¸åŒçš„MSBï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœp,qçš„å·®å€¼$|p-q|$æ¯”è¾ƒå°ï¼Œé‚£ä¹ˆå°±å¯ä»¥è®¡ç®—å‡ºä¸Šå¼ä¸­çš„dï¼Œå¹¶ä¸”åˆ†è§£æ¨¡æ•°mã€‚&lt;/p&gt;&#xA;&lt;h2 id=&#34;rsaå˜å¼&#34;&gt;RSAå˜å¼&lt;/h2&gt;&#xA;&lt;h3 id=&#34;rsa-luc&#34;&gt;RSA-LUC&lt;/h3&gt;&#xA;&lt;p&gt;1993å¹´ï¼ŒSmith å’Œ Lennon å‘è¡¨äº†ä¸€ä¸ªRSAå˜ç§å¯†ç ç³»ç»Ÿï¼Œå«åšLUCï¼ŒåŸºäº Lucas sequencesã€‚æ¨¡æ•°$N=pq$ï¼Œå…¬é’¥eå’Œç§é’¥dæ»¡è¶³ $ed\equiv1 \pmod{(p^2-1)(q^2-1)}$ã€‚&lt;/p&gt;&#xA;&lt;p&gt;è¿˜æœ‰å¾ˆå¤šå…¶ä»–çš„å˜å¼å¯ä»¥çœ‹åŸæ–‡ï¼Œè¿™äº›å˜å¼éƒ½æ»¡è¶³ $ed\equiv1 \pmod{(p^2-1)(q^2-1)}$ è¿™æ¡å¼å­ã€‚&lt;/p&gt;&#xA;&lt;p&gt;åé¢çš„ç ”ç©¶ä¸­ï¼ŒæŠŠè¿™æ¡å¼å­æ”¹å†™ä¸ºç­‰å¼ $ed-k(p^2-1)(q^2-1)=1$ ï¼Œå¹¶å¾—å‡º $\frac{k}{d}$ å¯ä»¥ç”¨ $e/(N^2-\frac{9}{4}N+1)$çš„ è¿åˆ†æ•°å½¢å¼çš„é€¼è¿‘æ¥è¡¨ç¤ºï¼Œå¦‚æœ $d &amp;lt; \sqrt{(2N^3-18N^2)/e}$ï¼Œè¿™ä¸ªæ–¹æ³•å°†éå¸¸æœ‰æ•ˆã€‚&lt;/p&gt;&#xA;&lt;p&gt;åœ¨2017å¹´ï¼ŒBunderå‘ç°å½“å…¬é’¥eæ»¡è¶³ $ex-(p^2-1)(q^2-1)y=z$ï¼Œå¯ä»¥å°†Coppersmithæ–¹æ³•å’Œè¿åˆ†æ•°æ–¹æ³•ç»“åˆèµ·æ¥ï¼Œå¦‚æœ $xy &amp;lt; 2N-4\sqrt{2}N^{\frac{3}{4}}$ ä¸” $|z| &amp;lt; |p-q|N^{\frac{1}{4}}y$ ï¼Œé‚£ä¹ˆå¯ä»¥å¾ˆæœ‰æ•ˆçš„åˆ†è§£Nï¼Œå½“z=1æ—¶ï¼Œä¸Šå¼å˜ä¸º $ed-k(p^2-1)(q^2-1)=1$ ï¼Œd çš„ä¸Šç•Œä¸º $d &amp;lt; \sqrt{2N-4\sqrt{2}N^{\frac{3}{4}}}$ ã€‚d å’Œ e çš„ç•Œä¹Ÿè¢«è€ƒè™‘æˆ $e = N^{\alpha}$ å’Œ $d = N^{\delta}$ ã€‚å†åˆ°åæ¥å¯†ç å­¦å®¶ä»¬å‘ç° $ed\equiv1 \pmod{(p^2-1)(q^2-1)}$ å¯ä»¥è¢«è§£å†³ï¼Œå¦‚æœ $\delta &amp;lt; \frac{7}{3} - \frac{2}{3}\sqrt{1+3\alpha}$ ã€‚&lt;/p&gt;&#xA;&lt;p&gt;è¿™ç¯‡è®ºæ–‡ä¸»è¦è®ºè¿°çš„æ˜¯RSAæ¨¡æ•°N=pqï¼Œä¸” $q &amp;lt; p &amp;lt; 2q$ï¼Œ$p-q=N^{\beta}$ã€‚å¦‚æœpå’Œqæ»¡è¶³ $q&amp;lt;p&amp;lt;2q$ï¼Œé‚£ä¹ˆ $\beta$ æ€»æ˜¯å°äº0.5çš„ï¼Œè€Œä¸”å½“ $\beta$ å°äº0.25æ—¶å°±å¯ä»¥è´¹é©¬åˆ†è§£çš„æ–¹æ³•ç›´æ¥åˆ†è§£Näº†ã€‚&lt;/p&gt;</description>
    </item>
    <item>
      <title>Elliptic Curve</title>
      <link>https://clingm.github.io/posts/crypto/elliptic-curve/</link>
      <pubDate>Thu, 15 Dec 2022 15:33:52 +0800</pubDate>
      <guid>https://clingm.github.io/posts/crypto/elliptic-curve/</guid>
      <description>&lt;h2 id=&#34;å®šä¹‰&#34;&gt;å®šä¹‰&lt;/h2&gt;&#xA;&lt;p&gt;åœ¨æ•°å­¦ä¸Šï¼Œ&lt;strong&gt;æ¤­åœ†æ›²çº¿&lt;/strong&gt;ï¼ˆElliptic curveï¼Œç¼©å†™ä¸ºECï¼‰ä¸ºä¸€&lt;a href=&#34;https://zh.wikipedia.org/wiki/%E4%BB%A3%E6%95%B0%E6%9B%B2%E7%BA%BF&#34; title=&#34;ä»£æ•°æ›²çº¿&#34;&gt;å¹³é¢ä»£æ•°æ›²çº¿&lt;/a&gt;ï¼Œç”±å¦‚ä¸‹å½¢å¼çš„æ–¹ç¨‹å®šä¹‰ $$ y^2=x^3 + ax + b $$&lt;/p&gt;&#xA;&lt;p&gt;å…¶ä¸­$a$å’Œ$b$ä¸ºå®æ•°ã€‚è¿™ç±»æ–¹ç¨‹è¢«ç§°ä¸ºshort Weierstrass ï¼ˆéŸ¦å°”æ–¯ç‰¹æ‹‰æ–¯ï¼‰æ–¹ç¨‹ã€‚æ¤­åœ†æ›²çº¿çš„å®šä¹‰ä¹Ÿè¦æ±‚æ›²çº¿æ˜¯éå¥‡å¼‚çš„ã€‚å‡ ä½•ä¸Šæ¥è¯´ï¼Œè¿™æ„å‘³ç€å›¾åƒé‡Œé¢æ²¡æœ‰å°–ç‚¹ã€è‡ªç›¸äº¤æˆ–å­¤ç«‹ç‚¹ã€‚ä»£æ•°ä¸Šæ¥è¯´ï¼Œè¿™æˆç«‹å½“ä¸”ä»…å½“åˆ¤åˆ«å¼ $$ \Delta=-16(4a^3+27b^2) $$ ä¸ç­‰äº0ã€‚ æœ‰short Weierstrassè‡ªç„¶ä¹Ÿæœ‰long Weierstrassæ–¹ç¨‹ $$ y^2+a_1xy+a_3y=x^3+a_2x^2+a_4x+a_6 $$ ï¼ˆè‡³äºä¸ºä»€ä¹ˆæ²¡æœ‰$a_5$æˆ‘ä¹Ÿä¸çŸ¥é“ï¼Œçœ‹è¿‡çš„èµ„æ–™é‡Œéƒ½æ˜¯æ²¡æœ‰$a_5$çš„ï¼‰ long Weierstrasså½¢å¼å¯ä»¥è½¬åŒ–ä¸ºshort Weierstrasså½¢å¼ã€‚ ä»¤$y\longrightarrow y-\frac{(a_1x+a_3)}{2}$ï¼ŒåŒ–ç®€å $$ y^2=x^3+Ax^2+Bx+C $$ å†ä»¤$x\longrightarrow x-\frac{A}{3}$ $$ y^2=x^3+ax+b $$&lt;/p&gt;&#xA;&lt;h2 id=&#34;å®æ•°åŸŸ&#34;&gt;å®æ•°åŸŸ&lt;/h2&gt;&#xA;&lt;h3 id=&#34;æ¤­åœ†æ›²çº¿çš„åŠ æ³•&#34;&gt;æ¤­åœ†æ›²çº¿çš„åŠ æ³•&lt;/h3&gt;&#xA;&lt;p&gt;ç”±æ¤­åœ†æ›²çº¿çš„åŠ æ³•å®šä¹‰ï¼šä¸¤ä¸ªç‚¹çš„è¿çº¿äº¤æ›²çº¿çš„ç¬¬ä¸‰ç‚¹å¹¶å–ä¸xè½´çš„å¯¹ç§°ç‚¹ã€‚ å¦‚è®¡ç®—$P=(X_p, Y_p)$å’Œ$Q=(X_Q, Y_Q)$çš„å’Œ$R=(X_R, Y_R)$ $$ \lambda=\frac{Y_Q-Y_P}{X_Q-X_P} $$ $$ X_R=\lambda^2-X_P-X_Q $$ $$ Y_R=\lambda(X_P-X_R)-Y_P $$ æˆ– $$ Y_R=\lambda(X_Q-X_R)-Y_Q $$&lt;/p&gt;&#xA;&lt;p&gt;å½“$P=Q$çš„æ—¶å€™ï¼Œ$P,Q$çš„è¿çº¿å˜æˆæ¤­åœ†æ›²çº¿çš„åˆ‡çº¿ã€‚æ­¤æ—¶å¯¹æ›²çº¿æ–¹ç¨‹çš„ä¸¤è¾¹å–å¾®åˆ†ï¼Œå¹¶ä¸”çŸ¥é“åˆ‡çº¿çš„æ–œç‡ç­‰äºyçš„å¾®åˆ†æ¯”xçš„å¾®åˆ† $$ 2yd_y=3x^2d_x+ad_x $$ æ•´ç†åå¾— $$ \lambda=\frac{d_y}{d_x}=\frac{3x^2+a}{2y} $$ è®¡ç®—$X_R,Y_R$çš„å…¬å¼ä¸ä¸Šé¢ç›¸åŒã€‚&lt;/p&gt;&#xA;&lt;h2 id=&#34;æœ‰é™åŸŸ&#34;&gt;æœ‰é™åŸŸ&lt;/h2&gt;&#xA;&lt;p&gt;å®é™…ä¸Šåœ¨å®šä¹‰åœ¨æœ‰é™åŸŸä¸Šçš„æ¤­åœ†æ›²çº¿çš„åŠ æ³•ä¹Ÿå¯ä»¥ç”¨å®æ•°åŸŸçš„å…¬å¼ï¼Œåªä¸è¿‡é™¤æ³•å˜æˆæ±‚é€†å…ƒ $$ \lambda=(Y_Q-Y_P)(X_Q-X_P)^{-1} \pmod{p} $$ å½“$P=Q$æ—¶ $$ \lambda=(3x^2+a)(2y)^{-1} \pmod{p} $$ ä½†æ˜¯è®¡ç®—ä¹˜æ³•é€†å…ƒæ€»æ˜¯å¤æ‚çš„ï¼ˆå³ä½¿ç”¨æ‹“å±•æ¬§å‡ é‡Œå¾·ç®—æ³•ï¼‰ã€‚æ‰€ä»¥ä»‹ç»ä¸‹å°„å½±å¹³é¢åæ ‡ã€‚&lt;/p&gt;</description>
    </item>
    <item>
      <title>Hitcon Ctf 2022 Secret</title>
      <link>https://clingm.github.io/posts/crypto/hitcon-ctf-2022-secret/</link>
      <pubDate>Fri, 02 Dec 2022 15:36:08 +0800</pubDate>
      <guid>https://clingm.github.io/posts/crypto/hitcon-ctf-2022-secret/</guid>
      <description>&lt;h2 id=&#34;æºç &#34;&gt;æºç &lt;/h2&gt;&#xA;&lt;p&gt;prob.py&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;import random, os&#xA;from Crypto.Util.number import getPrime, bytes_to_long&#xA;&#xA;p = getPrime(1024)&#xA;q = getPrime(1024)&#xA;n = p * q&#xA;&#xA;flag = open(&#39;flag&#39;,&#39;rb&#39;).read()&#xA;pad_length = 256 - len(flag)&#xA;m = bytes_to_long(os.urandom(pad_length) + flag)&#xA;assert(m &amp;lt; n)&#xA;es = [random.randint(1, 2**512) for _ in range(64)]&#xA;cs = [pow(m, p + e, n) for e in es]&#xA;print(es)&#xA;print(cs)&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 id=&#34;æ€è·¯&#34;&gt;æ€è·¯&lt;/h2&gt;&#xA;&lt;h3 id=&#34;recover-n&#34;&gt;Recover N&lt;/h3&gt;&#xA;&lt;p&gt;é¢˜ç›®ç»™å‡ºäº†64ç»„&lt;/p&gt;&#xA;&lt;p&gt;$$ c_i\equiv m^{p+e_i} \pmod{n} $$ ä½†æ˜¯å¹¶æ²¡æœ‰ç»™æ¨¡æ•°$n$ã€‚å…¶å®è¿™ç±»é¢˜ç›®åœ¨N1CTFï¼ˆEzDLPï¼‰ä»¥åŠmapleå¸ˆå‚…çš„å¦ä¸€é“&lt;a href=&#34;https://github.com/maple3142/My-CTF-Challenges/tree/master/ImaginaryCTF/Round%2026/no_modulus&#34;&gt;é¢˜ç›®&lt;/a&gt;ä¸­å‡ºç°è¿‡ã€‚&lt;/p&gt;&#xA;&lt;p&gt;éœ€è¦æ¢å¤æ¨¡æ•°ï¼Œå°±éœ€è¦æ„é€ å‡ºåƒè¿™æ ·çš„å¼å­&lt;/p&gt;</description>
    </item>
    <item>
      <title>Hitcon Ctf 2022 Superprime</title>
      <link>https://clingm.github.io/posts/crypto/hitcon-ctf-2022-superprime/</link>
      <pubDate>Wed, 30 Nov 2022 15:42:47 +0800</pubDate>
      <guid>https://clingm.github.io/posts/crypto/hitcon-ctf-2022-superprime/</guid>
      <description>&lt;blockquote&gt;&#xA;&lt;p&gt;ç»§ç»­å¤ç°HITCON CTF çš„èµ›é¢˜ã€‚äº‰å–è¿‘æœŸå…¨éƒ¨å¤ç°å®Œã€‚&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;h2 id=&#34;æºç &#34;&gt;æºç &lt;/h2&gt;&#xA;&lt;p&gt;chall.py&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;from Crypto.Util.number import getPrime, isPrime, bytes_to_long&#xA;&#xA;def getSuperPrime(nbits):&#xA;    while True:&#xA;        p = getPrime(nbits)&#xA;        pp = bytes_to_long(str(p).encode())&#xA;        if isPrime(pp):&#xA;            return p, pp&#xA;&#xA;&#xA;p1, q1 = getSuperPrime(512)&#xA;p2, q2 = getSuperPrime(512)&#xA;p3, q3 = getSuperPrime(512)&#xA;p4, q4 = getSuperPrime(512)&#xA;p5, q5 = getSuperPrime(512)&#xA;&#xA;n1 = p1 * q1&#xA;n2 = p2 * p3&#xA;n3 = q2 * q3&#xA;n4 = p4 * q5&#xA;n5 = p5 * q4&#xA;&#xA;e = 65537&#xA;c = bytes_to_long(open(&amp;quot;flag.txt&amp;quot;, &amp;quot;rb&amp;quot;).read().strip())&#xA;for n in sorted([n1, n2, n3, n4, n5]):&#xA;    c = pow(c, e, n)&#xA;&#xA;print(f&amp;quot;{n1 = }&amp;quot;)&#xA;print(f&amp;quot;{n2 = }&amp;quot;)&#xA;print(f&amp;quot;{n3 = }&amp;quot;)&#xA;print(f&amp;quot;{n4 = }&amp;quot;)&#xA;print(f&amp;quot;{n5 = }&amp;quot;)&#xA;print(f&amp;quot;{e = }&amp;quot;)&#xA;print(f&amp;quot;{c = }&amp;quot;)&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 id=&#34;æ€è·¯&#34;&gt;æ€è·¯&lt;/h2&gt;&#xA;&lt;p&gt;é¦–å…ˆå¯ä»¥ä»¤&lt;/p&gt;</description>
    </item>
    <item>
      <title>Hitcon Ctf 2022 Babysss</title>
      <link>https://clingm.github.io/posts/crypto/hitcon-ctf-2022-babysss/</link>
      <pubDate>Mon, 28 Nov 2022 15:46:12 +0800</pubDate>
      <guid>https://clingm.github.io/posts/crypto/hitcon-ctf-2022-babysss/</guid>
      <description>&lt;blockquote&gt;&#xA;&lt;p&gt;å‘¨æœ«æŠ½æ—¶é—´çœ‹äº†ä¸€ä¸‹HITCONçš„é¢˜ï¼Œä¸æ„§æ˜¯é¡¶å°–çš„æ¯”èµ›ã€‚ç”±äºæ°´å¹³æ¯”è¾ƒèœï¼Œåœ¨æ¯”èµ›æœŸé—´å°±åšå‡ºæ¥è¿™ä¹ˆä¸€é“é¢˜ï¼ˆå®é™…ä¸Šå°±å‘¨å…­æ—©ä¸Šçœ‹äº†ä¸€ä¸‹ï¼Œä¸‹åˆèµ¶ddlï¼Œå‘¨æ—¥æ‰“å®‰æ´µæ¯ï¼‰ã€‚&lt;a href=&#34;https://blog.maple3142.net/&#34;&gt;maple3142&lt;/a&gt;å¸ˆå‚…å’Œlycå¸ˆå‚…å‡ºçš„é¢˜ç›®è´¨é‡éƒ½å¾ˆé«˜ï¼Œè¿™ä¸ªæ˜ŸæœŸå†å¤ç°å­¦ä¹ ä¸€ä¸‹ã€‚&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;p&gt;chall.py&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;from random import SystemRandom&#xA;from Crypto.Cipher import AES&#xA;from hashlib import sha256&#xA;from secret import flag&#xA;&#xA;rand = SystemRandom()&#xA;&#xA;&#xA;def polyeval(poly, x):&#xA;    return sum([a * x**i for i, a in enumerate(poly)])&#xA;&#xA;&#xA;DEGREE = 128&#xA;SHARES_FOR_YOU = 8  # I am really stingy :)&#xA;&#xA;poly = [rand.getrandbits(64) for _ in range(DEGREE + 1)]&#xA;&#xA;shares = []&#xA;for _ in range(SHARES_FOR_YOU):&#xA;    x = rand.getrandbits(16)&#xA;    y = polyeval(poly, x)&#xA;    shares.append((x, y))&#xA;print(shares)&#xA;&#xA;secret = polyeval(poly, 0x48763)&#xA;key = sha256(str(secret).encode()).digest()[:16]&#xA;cipher = AES.new(key, AES.MODE_CTR)&#xA;print(cipher.encrypt(flag))&#xA;print(cipher.nonce)&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;output.txt&lt;/p&gt;</description>
    </item>
    <item>
      <title>Breaking Ecdsa From Nonce Bits</title>
      <link>https://clingm.github.io/posts/crypto/breaking-ecdsa-from-nonce-bits/</link>
      <pubDate>Tue, 22 Nov 2022 15:48:05 +0800</pubDate>
      <guid>https://clingm.github.io/posts/crypto/breaking-ecdsa-from-nonce-bits/</guid>
      <description>&lt;blockquote&gt;&#xA;&lt;p&gt;å¦‚æœå¯¹HNPä¸å¤ªäº†è§£ï¼Œå¯ä»¥å…ˆçœ‹ä¸€ä¸‹æˆ‘çš„å¦ä¸€ç¯‡æ–‡ç« &lt;a href=&#34;https://clingm.github.io/2022/11/18/Hidden-Number-Problem/&#34;&gt;HNP&lt;/a&gt;&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;h2 id=&#34;preview&#34;&gt;Preview&lt;/h2&gt;&#xA;&lt;p&gt;å…ˆç®€å•å›é¡¾ä¸€ä¸‹HNPå’ŒECDSAã€‚&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Hidden Number problemï¼ˆHNPï¼‰&lt;/strong&gt; ï¼šæœ‰ä¸€ä¸ªå¯¹å¤–ä¿å¯†çš„æ•°$\alpha$å’Œå¯¹å¤–å…¬å¼€çš„æ¨¡æ•°$n$ã€‚éšæœºçš„é€‰æ‹©$t_i$è®¡ç®—$s_i=\alpha t_i\ mod\ n$ï¼Œå¹¶ä¸”æ³„æ¼å‡º$s_i$çš„æœ€é«˜æœ‰æ•ˆä½ï¼Œå°±å¯ä»¥åˆ©ç”¨$CVP$çš„æ–¹æ³•å»æ¢å¤$\alpha$ã€‚&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;ECDSA&lt;/strong&gt; ï¼šåœ¨æœ‰é™åŸŸ$\mathbb{F}p$ä¸Šé€‰æ‹©æ¤­åœ†æ›²çº¿$E\left(\mathbb{F}_{p}\right)$ï¼Œä»¥åŠé˜¶ä¸º$n$çš„å­ç¾¤çš„åŸºç‚¹$G$ã€‚ç§é’¥ä¸º$0\leq d &amp;lt; n$ï¼Œå…¬é’¥ä¸º$dG=Q$ã€‚ ç­¾åï¼š&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;é€‰æ‹©nonceä¸ºéšæœºæ•°$k$&lt;/li&gt;&#xA;&lt;li&gt;è®¡ç®—æ˜æ–‡çš„$hash$ï¼Œ$h=Hash(m)$&lt;/li&gt;&#xA;&lt;li&gt;è®¡ç®—$r=(kG)_x$ï¼Œxè¡¨ç¤º$kG$çš„xåæ ‡&lt;/li&gt;&#xA;&lt;li&gt;è®¡ç®—$s = k^{-1} \cdot (h+d\cdot r)\ mod\ n$&lt;/li&gt;&#xA;&lt;li&gt;ç­¾åä¸º$(r, s)$&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 id=&#34;ecdsa-as-a-hnp&#34;&gt;ECDSA as a HNP&lt;/h2&gt;&#xA;&lt;p&gt;ç”±ECDSAçš„ç­¾åè¿‡ç¨‹ï¼Œé‡å†™ä¸€ä¸‹å…¬å¼ã€‚&lt;/p&gt;&#xA;&lt;p&gt;$$ -s^{-1}\cdot h + k\equiv s^{-1}\cdot r \cdot d \pmod{n} $$&lt;/p&gt;&#xA;&lt;p&gt;ä¸HNPé—®é¢˜å¯¹åº”ä¸€ä¸‹ï¼Œä»¤&lt;/p&gt;&#xA;&lt;p&gt;$$ \begin{aligned} \alpha=d \\ t_i=s^{-1}\cdot r \\ a_i = s^{-1}\cdot h \end{aligned} $$&lt;/p&gt;&#xA;&lt;p&gt;ç”±äºnonceç›¸è¾ƒäº$a_i$æ¥è¯´è¾ƒå°ï¼Œæ‰€ä»¥&lt;/p&gt;&#xA;&lt;p&gt;$$ \begin{aligned} MSB_{\alpha,k}(t_i) &amp;amp;= MSB_k(\alpha \cdot t_i\ mod\ n) \\ &amp;amp;= MSB_k(d\cdot s^{-1}\cdot r) \\ &amp;amp;= MSB_k(-a_i + k) \\ &amp;amp;= n-a_i \end{aligned} $$&lt;/p&gt;</description>
    </item>
    <item>
      <title>Hidden Number Problem</title>
      <link>https://clingm.github.io/posts/crypto/hidden-number-problem/</link>
      <pubDate>Fri, 18 Nov 2022 15:49:12 +0800</pubDate>
      <guid>https://clingm.github.io/posts/crypto/hidden-number-problem/</guid>
      <description>&lt;blockquote&gt;&#xA;&lt;p&gt;åœ¨æœ€è¿‘çš„å¾ˆå¤šæ¯”èµ›éƒ½é‡åˆ°äº†è¿™ä¸ªHidden Number Problem(HNP)ï¼Œæ‰€ä»¥æŠ½ä¸ªæ—¶é—´æ¥ä»”ç»†å­¦ä¹ ä¸€ä¸‹ï¼Œç„¶åé©¬ä¸Šè¦HGAME2023äº†ï¼Œæ­£å¥½å‡†å¤‡ä¸€ä¸‹é¢˜ç›®ç»™æ–°ç”Ÿå†™ã€‚&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;h2 id=&#34;introduce&#34;&gt;Introduce&lt;/h2&gt;&#xA;&lt;p&gt;HNPé—®é¢˜ç¬¬ä¸€æ¬¡è¢«æå‡ºæ˜¯åœ¨è¿™ç¯‡è®ºæ–‡ä¸­Â &lt;a href=&#34;https://crypto.stanford.edu/~dabo/pubs/abstracts/dhmsb.html&#34;&gt;â€œHardness of computing the most significant bits of secret keys in Diffie-Hellman and related schemesâ€ by Dan Boneh and Ramarathnam Venkatesan&lt;/a&gt;ã€‚HNPé—®é¢˜æœ¬æ¥æ˜¯ç”¨æ¥ç ”ç©¶Diffie-Hellmanå…±äº«å¯†é’¥ä¸­çš„æœ€é«˜æœ‰æ•ˆä½æ˜¯å¦ä¸æ•´ä¸ªç§˜å¯†ä¸€æ ·éš¾ä»¥è®¡ç®—ï¼Ÿå¹¶ä¸”D. Bonehå’ŒR. Venkatesanè¿˜å±•ç¤ºäº†ä¸€ç§æœ‰æ•ˆçš„ç®—æ³•ï¼Œç”¨äºåœ¨æœ‰è¶³å¤Ÿå¤§çš„ä½æ³„æ¼çš„æƒ…å†µä¸‹æ¢å¤å¯†é’¥ã€‚&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;è¿™ä¸ªæ–¹æ³•ç”¨åˆ°äº†æ ¼å’Œæ ¼åŸºè§„çº¦çš„ç®—æ³•ï¼Œä¸€å¼€å§‹å­¦ä¹ æ ¼å¯†ç æ—¶æŠŠé‡ç‚¹æ”¾åœ¨äº†åŸºäºæ ¼çš„å¯†é’¥ç³»ç»Ÿçš„å­¦ä¹ ä¸Šï¼Œä½†æ ¼ç»ˆç©¶æ˜¯æ•°å­¦ä¸Šçš„ä¸œè¥¿ï¼Œæ•°å­¦è¯´ç™½äº†å°±æ˜¯ä¸€ä¸ªå·¥å…·ï¼Œé‚£ä¹ˆæ ¼è‡ªç„¶ä¹Ÿæ˜¯ä¸€ä¸ªå·¥å…·ï¼Œåªä¸è¿‡æˆ‘ä»¬æŠŠæ ¼è¿™ä¸ªæœ‰åŠ›çš„å·¥å…·ç”¨åœ¨äº†å¯†ç åˆ†æä¸Šè€Œå·²ã€‚&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;h2 id=&#34;how-is-the-hnp-defined&#34;&gt;How is the HNP defined&lt;/h2&gt;&#xA;&lt;p&gt;è®ºæ–‡ä¸­é¦–å…ˆæå‡ºäº†most significant bitsï¼ˆMSBï¼‰çš„å®šä¹‰ã€‚é¦–å…ˆä»¤$p$æ˜¯ä¸€ä¸ªç´ æ•°ï¼Œ$n$æ˜¯$p$çš„äºŒè¿›åˆ¶ä½æ•°ï¼Œå³$n=log_2(p)$ï¼Œç”¨$x\ mod\ p$æ¥è¡¨ç¤ºä¸€ä¸ªå®šä¹‰åœ¨æœ‰é™åŸŸçš„æ•°$a \in GF(p)$ï¼Œå³$x \equiv a \pmod{p}$ã€‚å®šä¹‰$MSB_k(x)$çš„å€¼ä¸º$t$å¹¶ä¸” $(t-1)\cdot p/2^k\leq x &amp;lt;t \cdot p/2^k$ï¼Œæˆ–è€…æ›´ç®€å•çš„å®šä¹‰ $$ MSB_k(x)=z,\quad |x-z|&amp;lt; p/2^k $$&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;About the $MSB_k(x)$&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;ä¸€çœ‹åˆ°most signficant bitså¯èƒ½å¾ˆå¤šäººéƒ½ä¼šæƒ³å½“ç„¶çš„è®¤ä¸ºæ˜¯$x$çš„æœ€é«˜$k$ä½ã€‚å…¶å®ä¸ç„¶ï¼Œæ ¹æ®å®šä¹‰ï¼Œå¯ä»¥å†™ä¸€ä¸ªå°demo&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;from random import randint&#xA;from sage.all import *&#xA;from Crypto.Util.number import getPrime&#xA;# Some parameters of the game, chosen for simplicity.&#xA;&#xA;# p - A prime number for our field.&#xA;p = getPrime(128)&#xA;&#xA;# n - The number of bits in `p`.&#xA;n = ceil(log(p, 2))&#xA;&#xA;# k - The number of significant bits revealed by the oracle.&#xA;# Using parameters from Thereom 1.&#xA;k = ceil(sqrt(n)) + ceil(log(n, 2))&#xA;print(f&amp;quot;The number of significant bits = {k}&amp;quot;)&#xA;&#xA;def msb(query):&#xA;    &amp;quot;&amp;quot;&amp;quot;Returns the MSB of query based on the global paramters p, k.&#xA;    &amp;quot;&amp;quot;&amp;quot;&#xA;    while True:&#xA;        z = randint(1, p-1)&#xA;        answer = abs(query - z)&#xA;        if answer &amp;lt; p / 2**(k+1):&#xA;            break&#xA;    return z&#xA;&#xA;x = randint(1, p-1)&#xA;print(f&amp;quot;x = {x}&amp;quot;)&#xA;print(f&amp;quot;MSB&#39;s output = {msb(x)}&amp;quot;)&#xA;print(f&amp;quot;most k bit of x = {x &amp;gt;&amp;gt; (n - k)}&amp;quot;)&#xA;&#xA;&#39;&#39;&#39;&#xA;The number of significant bits = 19&#xA;x = 54914319491231438995398843041850226262&#xA;MSB&#39;s output = 54914493779494223381640832877194242316&#xA;|MSB(x) - x| = 124182961411716441204715130169529&#xA;most k bit of x = 84608&#xA;&#39;&#39;&#39;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;å¦‚ä½•å»ç†è§£è¿™ä¸ª$MSB_k(x)$å‘¢ï¼Œä¸éš¾å¾—å‡ºä»¥ä¸‹å‡ ç‚¹ï¼š&lt;/p&gt;</description>
    </item>
    <item>
      <title>A New Elliptic Curve Based Analogue of Rsa</title>
      <link>https://clingm.github.io/posts/crypto/a-new-elliptic-curve-based-analogue-of-rsa/</link>
      <pubDate>Sun, 02 Oct 2022 15:50:47 +0800</pubDate>
      <guid>https://clingm.github.io/posts/crypto/a-new-elliptic-curve-based-analogue-of-rsa/</guid>
      <description>&lt;h3 id=&#34;refer-a-new-elliptic-curve-based-analogue-of-rsahttpslinkspringercomcontentpdf1010073-540-48285-7_4pdf&#34;&gt;refer: &lt;a href=&#34;https://link.springer.com/content/pdf/10.1007/3-540-48285-7_4.pdf&#34;&gt;A New Elliptic Curve Based Analogue of RSA&lt;/a&gt;&lt;/h3&gt;&#xA;&lt;h2 id=&#34;æ¤­åœ†æ›²çº¿&#34;&gt;æ¤­åœ†æ›²çº¿&lt;/h2&gt;&#xA;&lt;p&gt;ä»¤ p å’Œ q æ˜¯ç´ æ•°ï¼Œéƒ½å¤§äº3ã€‚å¹¶ä¸”æ»¡è¶³$4a^3 + 27b^2 \not\equiv 0 \pmod{p}$ã€‚ç”¨$E_p(a, b)$è¡¨ç¤ºæ¨¡på‚æ•°ä¸ºa,bçš„æ¤­åœ†æ›²çº¿ã€‚$y^2 \equiv x^3 + ax + b \pmod{p}$ã€‚&lt;/p&gt;&#xA;&lt;p&gt;æ¤­åœ†æ›²çº¿çš„åŠ æ³•è®¡ç®—å®šä¹‰ä¸º&lt;/p&gt;&#xA;&lt;p&gt;$$ P+Q=R \tag 1 $$&lt;/p&gt;&#xA;&lt;p&gt;è®¾$P=(x_1, y_1)ï¼ŒQ=(x_2,y_2)ï¼ŒR=(x_3, y_3)$&lt;/p&gt;&#xA;&lt;p&gt;$$ x3 \equiv \lambda^2-x_1-x_2 \mod{p} \tag 2 $$&lt;/p&gt;&#xA;&lt;p&gt;$$ y_3\equiv \lambda(x_1-x_3) - y_1 \pmod{p} $$&lt;/p&gt;&#xA;&lt;p&gt;$$ \lambda \equiv \begin{cases} \frac{y_1-y_2}{x_1-x_2} &amp;amp; if x_1 \not\equiv x_2 \pmod{p} \\ \\ \frac{3x_1^2 + a}{2y_1} &amp;amp; ifx1=x2 \pmod{p} \end{cases} $$&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
